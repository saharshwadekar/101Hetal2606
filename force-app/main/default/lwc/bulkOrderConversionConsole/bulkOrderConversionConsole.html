<template>
    <div class="slds-theme_shade">
        <div class="slds-is-relative slds-p-around_medium">            
            <!-- Select Bulk Action type tab -->
            <template if:true={showBulkActionSelection}>
                <div class="slds-grid slds-gutters slds-gutters_x-small">
                    <div class="slds-col slds-size_1-of-3 slds-grid">
                        <div class="slds-theme_default slds-box slds-box_small slds-size_1-of-1">
                            <div class="slds-grid slds-wrap slds-gutters slds-gutters_small">
                                <div class="slds-col slds-size_1-of-1 slds-grid slds-grid_vertical-align-center">
                                    <p>{bulkActionTypeName}</p>
                                </div>
                            </div>
                            <div class="slds-grid slds-grid_vertical slds-gutters slds-gutters_small">
                                <template for:each={showBulkActionType} for:item="item">
                                    <div class="slds-col slds-size_1-of-1 slds-m-top_small" key={item.bulkActionTypeId}>
                                        <div class="bulk-action-type slds-box slds-box_x-small slds-box_xx-small slds-text-link_reset" data-label="Bulk Action Type" onclick={handleCardSelection} data-value={item.title} data-id={item.bulkActionTypeId}>
                                            <div class="slds-grid slds-m-bottom_xxx-small slds-grid_vertical-align-center">
                                                <template lwc:if={item.selected}>
                                                    <lightning-icon icon-name="action:approval" title="Approval" size="xx-small" class="dmpl_color-blue"></lightning-icon>
                                                </template>
                                                <template lwc:else>
                                                    <lightning-icon icon-name={item.iconName} title="custom108" size="xx-small" style={getRandomColor}></lightning-icon>
                                                </template>
                                                <p class="slds-text-heading_medium slds-m-left_x-small">{item.title}</p>
                                            </div>
                                            <p class="slds-text-body_small">{item.description}</p>
                                        </div>
                                    </div>
                                </template>
                            </div>
                        </div>
                    </div>
                    <template if:true={showHistory}>
                        <div class="slds-col slds-grid slds-size_2-of-3">
                            <div class="slds-box slds-p-around_none slds-theme_default slds-col slds-size_1-of-1 slds-grid slds-grid_vertical">
                                <div class="slds-grid slds-grid_vertical-align-center slds-grid_align-spread slds-p-around_small slds-border_bottom">
                                    <div class="slds-box slds-p-around_none slds-grid slds-grid_vertical-align-center slds-p-around_none slds-m-right_small">
                                        <p class="history-filter slds-text-body_small slds-p-around_xx-small slds-border_right slds-text-link_reset dmpl-active" data-value="total" onclick={handleHistoryFilter}>Total Records: <b>{allHistoryLogsLength}</b></p>
                                        <p class="history-filter slds-text-body_small slds-border_right slds-p-around_xx-small slds-text-link_reset" data-value="processed" onclick={handleHistoryFilter}>Processed: <b>{processedHistoryLogsLength}</b></p>
                                        <p class="history-filter slds-text-body_small slds-border_right slds-p-around_xx-small  slds-text-link_reset" data-value="failed" onclick={handleHistoryFilter}>Failed: <b>{failedHistoryLogsLength}</b></p>
                                        <p class="history-filter slds-text-body_small slds-border_right slds-p-around_xx-small slds-text-link_reset" data-value="queued" onclick={handleHistoryFilter}>Queued: <b>{queuedHistoryLogsLength}</b></p>
                                        <p class="history-filter slds-text-body_small slds-p-around_xx-small slds-text-link_reset" data-value="processing" onclick={handleHistoryFilter}>Processing: <b>{pendingHistoryLogsLength}</b></p>
                                    </div>
                                    <div class="slds-grid slds-grid_vertical-align-center">
                                        <lightning-input type="search" label="Submitted By" value={searchKey} placeholder="Search Batch Number..." onchange={handleHistorySearch} variant="label-hidden"></lightning-input>
                                        <lightning-button-icon icon-name="utility:refresh" variant="border-filled" alternative-text="Refresh" title="Refresh" class="slds-m-left_xx-small" onclick={handleRefresh}></lightning-button-icon>
                                        <lightning-button-icon icon-name="utility:download" variant="border-filled" alternative-text="Download" title="Download" class="slds-m-left_xx-small" onclick={handleDownload}></lightning-button-icon>
                                    </div>
                                </div>
                                <!-- Datatable here -->
                                <lightning-datatable
                                    key-field="id"
                                    data={historyLogs}
                                    columns={historyColumns}
                                    show-row-number-column
                                    onrowaction={handleRowAction}
                                    onrowselection={handleSelectedRows}>
                                </lightning-datatable>
                            </div>
                        </div>
                    </template>
                    <template if:true={showDocumentType}>
                        <div class={computedDocumentTypeClasses}>
                            <div class="slds-box slds-box_small slds-theme_default slds-col slds-size_1-of-1 slds-grid">
                                <div class="slds-col slds-size_1-of-1">
                                        <p>Select Document Type</p>
                                    <div class="slds-grid slds-wrap slds-gutters slds-gutters_x-small">
                                        <template for:each={documentTypeData} for:item="item">
                                            <div class={computedDocumentCardClasses} key={item.documentTypeId}>
                                                <div class="bulk-action-type slds-box slds-box_x-small slds-box_xx-small slds-text-link_reset" data-label="Document Type" onclick={handleCardSelection} data-value={item.title} data-id={item.documentTypeId}>
                                                    <div class="slds-grid slds-m-bottom_xxx-small slds-grid_vertical-align-center">
                                                        <template lwc:if={item.selected}>
                                                            <lightning-icon icon-name="action:approval" title="Approval" size="xx-small" class="dmpl_color-blue"></lightning-icon>
                                                        </template>
                                                        <template lwc:else>
                                                            <lightning-icon icon-name={item.iconName} title="custom108" size="xx-small" style={getRandomColor}></lightning-icon>
                                                        </template>
                                                        <p class="slds-text-heading_medium slds-m-left_x-small">{item.title}</p>
                                                    </div>
                                                    <p class="slds-text-body_small">{item.description}</p>
                                                </div>
                                            </div>
                                        </template>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </template>
                    <template if:true={showAllocationTypeData}>
                        <div class="slds-col slds-size_1-of-3 slds-grid">
                            <div class="slds-box slds-box_small slds-theme_default slds-col slds-size_1-of-1 slds-grid">
                                <div class="slds-col slds-size_1-of-1">
                                    <p>Select Allocation Type</p>
                                    <div class="slds-grid slds-wrap slds-gutters slds-gutters_small">
                                        <template for:each={allocationTypeData} for:item="item">
                                            <div class="slds-col slds-size_1-of-1 slds-m-top_small" key={item.allocationTypeId}>
                                                <div class="bulk-action-type slds-box slds-box_x-small slds-box_xx-small slds-text-link_reset" data-label="Allocation Type" onclick={handleCardSelection} data-value={item.title} data-id={item.allocationTypeId}>
                                                    <div class="slds-grid slds-m-bottom_xxx-small slds-grid_vertical-align-center">
                                                        <template lwc:if={item.selected}>
                                                            <lightning-icon icon-name="action:approval" title="Approval" size="xx-small" class="dmpl_color-blue"></lightning-icon>
                                                        </template>
                                                        <template lwc:else>
                                                            <lightning-icon icon-name={item.iconName} title="custom108" size="xx-small" style={getRandomColor}></lightning-icon>
                                                        </template>
                                                        <p class="slds-text-heading_medium slds-m-left_x-small">{item.title}</p>
                                                    </div>
                                                    <p class="slds-text-body_small">{item.description}</p>
                                                </div>
                                            </div>
                                        </template>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </template>
                </div> 
            </template>

            <!-- Edit and Process tab -->
            <template if:true={showEditAndProcess}>
                <!-- <div class="slds-grid slds-grid_align-start slds-m-bottom_small">
                    <div class="slds-grid slds-grid_align-start slds-box slds-box_x-small slds-grid slds-grid_vertical-align-center slds-text-link_reset" data-label="All Sale Orders" onclick={handleBack}>
                        <lightning-icon icon-name="utility:chevronleft" title="chevronleft" class="slds-m-right_xx-small" size="xx-small"></lightning-icon>
                        <p class="slds-text-body_small">Back to Bulk Action Selection</p>
                    </div>
                </div> -->
                <div class="slds-box slds-box_small slds-theme_default">
                    <div class="slds-grid slds-wrap">
                        <div class="slds-col slds-size_1-of-1 slds-grid slds-grid_vertical-align-center slds-grid_align-spread">
                            <div class="slds-grid slds-grid_vertical-align-center">
                                <lightning-icon icon-name="standard:filter" title="filter"></lightning-icon>
                                <p class="header_title slds-p-left_x-small">Filters</p>
                            </div>
                            <div class="slds-grid slds-grid_vertical-align-center">
                                <template if:false={showHistory}>
                                    <lightning-button label="+ Custom Filter" title="Custom Filter" onclick={openPopup} class="slds-m-right_x-small"></lightning-button>
                                </template>
                                <lightning-button label="Clear Filters" variant="neutral" onclick={handleClearAllPills} class="slds-m-right_x-small"></lightning-button>
                                <lightning-button label={filtersLabel} title={filtersLabel} onclick={toggleFilters}></lightning-button>
                            </div>
                        </div>
                    </div>
                    <template if:true={showFilters}>
                        <div class="slds-grid slds-wrap slds-grid_vertical-align-end slds-gutters slds-gutters_small slds-m-top_xx-small slds-p-horizontal_small">
                            <div class="slds-grid dmpl-flex-1">
                                <lightning-record-edit-form id="lightning-record-form1" density="comfy" object-api-name={objectApiName} class="slds-size_1-of-1">
                                    <div class="slds-grid">
                                        <template for:each={fieldsetFields.data} for:item="field">
                                            <div key={field.apiName} class="dmpl-flex-1 slds-m-right_small">
                                                <template if:false={field.isCustomLookup}>
                                                    <lightning-input-field id={field.apiName} field-name={field.apiName} disabled={field.disabled}
                                                        required={field.required} class="slds-text-body_small slds-p-around_none slds-m-bottom_none slds-form-element slds-form-element_stacked" onchange={handleChange}> 
                                                    </lightning-input-field>
                                                </template>
                                            </div>  
                                        </template>
                                    </div>
                                </lightning-record-edit-form>
                            </div>
                            <div class="slds-grid">
                                <lightning-button label="Search" title="Search" onclick={handleSearchClick}></lightning-button>
                            </div>
                        </div>
                    </template>
                    <template if:true={customLogicData.length}>
                        <div class="slds-grid slds-m-top_small slds-p-top_small slds-border_top">
                            <div class="slds-col slds-size_1-of-1 slds-grid slds-grid_vertical-align-center slds-grid">
                                <template for:each={customLogicData} for:item="condition">
                                    <div class="slds-is-relative slds-m-right_x-small" key={condition.Id}>
                                        <c-custom-pill label={condition.conditionName} name={condition.conditionName} lwc:spread={condition} onremove={handlePillRemove}></c-custom-pill>
                                    </div>
                                </template>
                            </div>
                        </div>
                    </template>
                </div>
                <div class="slds-box slds-box_small slds-m-top_medium slds-theme_default slds-p-around_none">
                    <div class="slds-grid slds-wrap slds-grid_vertical-align-center slds-grid_align-spread slds-m-around_small">
                        <div class="slds-col slds-grid slds-grid_vertical-align-center">
                            <lightning-icon icon-name="custom:custom15" title="custom15"></lightning-icon>
                            <p class="slds-p-left_x-small">All Sale Orders</p>
                        </div>
                        <lightning-button variant="brand" label="Process" title="Process" onclick={handleProcessInvoice}></lightning-button>
                    </div>
                    <div class="slds-grid slds-wrap slds-grid_vertical-align-center slds-grid_align-spread slds-m-bottom_small slds-m-horizontal_small">
                        <p class="slds-text-body_small">50+ Items . Updated 5 minutes ago</p>
                        <div class="slds-grid slds-grid_vertical-align-center">
                            <lightning-input type="search" label="Search" value={searchKey} placeholder="Search Outlet Name..." onchange={handleSaleOrdersSearch} variant="label-hidden"></lightning-input>
                            <lightning-button-icon icon-name="utility:refresh" variant="border-filled" alternative-text="Refresh" title="Refresh" class="slds-m-left_small" onclick={handleRefresh}></lightning-button-icon>
                        </div>
                    </div>
                    <!-- Datatable here -->
                    <lightning-datatable
                        key-field="id"
                        data={saleOrderLinesData}
                        columns={columnsData}
                        show-row-number-column
                        onrowaction={handleRowAction}
                        onrowselection={handleSelectedRows}>
                    </lightning-datatable>
                </div>
                <!-- <template if:true={getData.length}>
                <div class="custom-datatable-wrapper slds-box slds-p-around_none">
                    <lightning-datatable key-field="Id" data={getData} columns={columns} sorted-by={sortBy}
                    sorted-direction={sortDirection} onsort={doSorting} oncellchange={handleCellChange}
                    suppress-bottom-bar wrap-text-max-lines=9 onrowselection={handleRowSelection}></lightning-datatable>
                </div>
                </template>
                <template if:false={getData.length}>
                <div class="slds-align_absolute-center custom-datatable-wrapper">
                    <div class="slds-illustration slds-illustration_medium slds-p-vertical_xx-small">
                    <div class="slds-illustration slds-illustration_small">
                        <svg class="slds-illustration__svg" viewBox="0 0 350 200" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">
                        <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                        <g transform="translate(-77.000000, -60.000000)">
                        <g>
                        <g transform="translate(190.000000, 206.000000)" class="slds-illustration__stroke-secondary" stroke-linecap="round" stroke-width="3">
                        <path vector-effect="non-scaling-stroke" d="M44,17.5 L63,17.5 C62.2789714,12.0723971 64.081543,7.53186978 68.4077148,3.87841797 C73.3754883,-0.195556641 79.2734375,0.717773438 82.440918,2.12353516 C85.6083984,3.52929687 87.9606934,5.46069336 89.5913086,9.10524041 C90.2822266,10.6397351 90.7517904,11.9379883 91,13"></path>
                        <path vector-effect="non-scaling-stroke" d="M83,20.5 C84.0558268,16.8461914 86.2227376,14.4572754 89.5007324,13.333252 C94.4177246,11.6472168 99.0800781,13.8925781 100.942383,16.1518555 C102.804687,18.4111328 103.39502,20.2260742 103.746582,22.1201172 C103.980957,23.3828125 104.06543,24.8427734 104,26.5 C108.141764,26.3313802 110.918945,27.1647135 112.331543,29 C114.040039,31.1936035 114.215332,33.817627 113.593018,35.75 C112.970703,37.682373 110.894531,40.5 107,40.5 L28,40.5"></path>
                        <path vector-effect="non-scaling-stroke" d="M18,27.5 L83.0004985,27.5"></path>
                        <path vector-effect="non-scaling-stroke" d="M0,27.5 L8,27.5"></path>
                        </g>
                        <g transform="translate(300.000000, 161.000000)" class="slds-illustration__stroke-secondary" stroke-linecap="round" stroke-width="3">
                        <path vector-effect="non-scaling-stroke" d="M44,17.5 L63,17.5 C62.2789714,12.0723971 64.081543,7.53186978 68.4077148,3.87841797 C73.3754883,-0.195556641 79.2734375,0.717773438 82.440918,2.12353516 C85.6083984,3.52929687 87.9606934,5.46069336 89.5913086,9.10524041 C90.2822266,10.6397351 90.7517904,11.9379883 91,13"></path>
                        <path vector-effect="non-scaling-stroke" d="M83,20.5 C84.0558268,16.8461914 86.2227376,14.4572754 89.5007324,13.333252 C94.4177246,11.6472168 99.0800781,13.8925781 100.942383,16.1518555 C102.804687,18.4111328 103.39502,20.2260742 103.746582,22.1201172 C103.980957,23.3828125 104.06543,24.8427734 104,26.5 C108.141764,26.3313802 110.918945,27.1647135 112.331543,29 C114.040039,31.1936035 114.215332,33.817627 113.593018,35.75 C112.970703,37.682373 110.894531,40.5 107,40.5 L28,40.5"></path>
                        <path vector-effect="non-scaling-stroke" d="M18,27.5 L83.0004985,27.5"></path>
                        <path vector-effect="non-scaling-stroke" d="M0,27.5 L8,27.5"></path>
                        </g>
                        <g transform="translate(79.000000, 249.000000)">
                        <path vector-effect="non-scaling-stroke" d="M0,62.5 L450,62.5" class="slds-illustration__stroke-secondary" stroke-width="3" stroke-linecap="round"></path>
                        <polyline vector-effect="non-scaling-stroke" class="slds-illustration__stroke-secondary" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" points="32 62 107.5 0 165.5 45.1232877"></polyline>
                        <polyline vector-effect="non-scaling-stroke" class="slds-illustration__stroke-secondary" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" points="148 30.9433962 165.5 16 222 62"></polyline>
                        <path vector-effect="non-scaling-stroke" d="M42.8943213,32.968973 L46.3925781,49.4296875 L34.453125,58.6445312 L40.9466068,32.9319979 C41.081836,32.3965247 41.6255477,32.0720629 42.1610209,32.2072921 C42.5306645,32.3006424 42.8150677,32.5960527 42.8943213,32.968973 Z"
                        class="slds-illustration__fill-secondary"></path>
                        <path vector-effect="non-scaling-stroke" d="M199.962964,27.4391572 L206,49 L194.770218,39.1063642 L198.037036,27.4391572 C198.185948,26.9073269 198.7378,26.5969106 199.26963,26.7458231 C199.605963,26.8399963 199.868791,27.1028246 199.962964,27.4391572 Z"
                        class="slds-illustration__fill-secondary"></path>
                        <path vector-effect="non-scaling-stroke" d="M47.9662349,37.3583594 L50.4271384,46.5867475 L46.8251953,48.7349783 L43,48.7349783 L46.0337651,37.3583594 C46.1760682,36.8247225 46.7240258,36.5074839 47.2576627,36.6497871 C47.6036917,36.7420615 47.8739605,37.0123303 47.9662349,37.3583594 Z"
                        class="slds-illustration__fill-secondary"></path>
                        </g>
                        <g transform="translate(394.000000, 265.500000) scale(-1, 1) translate(-394.000000, -265.500000) translate(288.000000, 222.000000)">
                        <polyline vector-effect="non-scaling-stroke" class="slds-illustration__stroke-secondary" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" points="0.5 87 87.5 0 153.5 68"></polyline>
                        <path vector-effect="non-scaling-stroke" d="M8.16064153,59.5904583 L14.229782,83 L3,71.1063642 L6.22968061,59.5717906 C6.37859311,59.0399602 6.93044422,58.729544 7.46227456,58.8784565 C7.80524768,58.9744889 8.07125785,59.2456927 8.16064153,59.5904583 Z"
                        class="slds-illustration__fill-secondary" transform="translate(8.614891, 70.920583) scale(-1, 1) translate(-8.614891, -70.920583) "></path>
                        <polyline vector-effect="non-scaling-stroke" class="slds-illustration__stroke-secondary" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" points="135.5 46 158.5 25 211.5 78"></polyline>
                        </g>
                        <g transform="translate(406.500000, 262.500000)">
                        <g class="slds-illustration__fill-secondary">
                        <path vector-effect="non-scaling-stroke" d="M18.9209988,1.95433401 L33.259296,51.443436 C33.5666778,52.5043744 32.9557995,53.613617 31.8948612,53.9209988 C31.7139843,53.9734036 31.5266126,54 31.3382972,54 L2.6617028,54 C1.5571333,54 0.661702805,53.1045695 0.661702805,52 C0.661702805,51.8116846 0.688299176,51.6243129 0.74070397,51.443436 L15.0790012,1.95433401 C15.386383,0.893395645 16.4956256,0.282517358 17.556564,0.589899164 C18.2152102,0.780726338 18.7301717,1.29568777 18.9209988,1.95433401 Z"></path>
                        </g>
                        <g class="slds-illustration__stroke-primary" stroke-linecap="round" stroke-width="3">
                        <polygon vector-effect="non-scaling-stroke" stroke-linejoin="round" points="17 0.323943662 34 54 -1.81721305e-12 54"></polygon>
                        <path vector-effect="non-scaling-stroke" d="M17,3.6953125 C17,42.0456294 17,61.6471919 17,62.5 C17,61.6471919 17,42.0456294 17,3.6953125 Z"></path>
                        <path vector-effect="non-scaling-stroke" d="M17,29.3239437 C22.3333333,35.7851611 25,39.1184944 25,39.3239437 C25,39.1184944 22.3333333,35.7851611 17,29.3239437 Z" stroke-linejoin="round" transform="translate(21.000000, 34.323944) scale(-1, 1) translate(-21.000000, -34.323944) "></path>
                        </g>
                        </g>
                        <g transform="translate(363.000000, 229.500000)">
                        <g transform="translate(1.000000, 0.000000)" class="slds-illustration__fill-secondary">
                        <path vector-effect="non-scaling-stroke" d="M25.6478873,0 L50.879042,84.4273253 C51.1953215,85.4856452 50.5937789,86.5999782 49.535459,86.9162577 C49.3496374,86.9717906 49.1567264,87 48.9627843,87 L2.33299037,87 C1.22842087,87 0.332990367,86.1045695 0.332990367,85 C0.332990367,84.8060578 0.361199757,84.6131469 0.416732643,84.4273253 L25.6478873,0 Z"></path>
                        </g>
                        <g class="slds-illustration__stroke-primary" stroke-linecap="round" stroke-width="3">
                        <polygon vector-effect="non-scaling-stroke" stroke-linejoin="round" points="26.5 0 52.5 87 0.5 87"></polygon>
                        <path vector-effect="non-scaling-stroke" d="M26.5,2.58642578 C26.5,63.0261034 26.5,93.9972948 26.5,95.5 C26.5,93.9972948 26.5,63.0261034 26.5,2.58642578 Z"></path>
                        <path vector-effect="non-scaling-stroke" d="M15.6478873,42 C22.9812207,49.078692 26.6478873,52.7453587 26.6478873,53 C26.6478873,52.7453587 22.9812207,49.078692 15.6478873,42 Z" stroke-linejoin="round"></path>
                        <path vector-effect="non-scaling-stroke" d="M27.6478873,68 C36.9812207,57.078692 41.6478873,51.7453587 41.6478873,52 C41.6478873,51.7453587 36.9812207,57.078692 27.6478873,68 Z" stroke-linejoin="round"></path>
                        </g>
                        </g>
                        <g transform="translate(118.500000, 262.500000)">
                        <g transform="translate(27.000000, 0.000000)" class="slds-illustration__fill-secondary">
                        <path vector-effect="non-scaling-stroke" d="M18.9209988,1.95433401 L33.259296,51.443436 C33.5666778,52.5043744 32.9557995,53.613617 31.8948612,53.9209988 C31.7139843,53.9734036 31.5266126,54 31.3382972,54 L2.6617028,54 C1.5571333,54 0.661702805,53.1045695 0.661702805,52 C0.661702805,51.8116846 0.688299176,51.6243129 0.74070397,51.443436 L15.0790012,1.95433401 C15.386383,0.893395645 16.4956256,0.282517358 17.556564,0.589899164 C18.2152102,0.780726338 18.7301717,1.29568777 18.9209988,1.95433401 Z"></path>
                        </g>
                        <g class="slds-illustration__stroke-primary" stroke-width="3">
                        <polygon vector-effect="non-scaling-stroke" stroke-linecap="round" stroke-linejoin="round" points="44 0.323943662 61 54 27 54"></polygon>
                        <path vector-effect="non-scaling-stroke" d="M44,4.32394366 C44,42.2551731 44,61.6471919 44,62.5 C44,61.6471919 44,42.2551731 44,4.32394366 Z"></path>
                        <path vector-effect="non-scaling-stroke" d="M44,32.3239437 C50.6666667,39.4518278 54,43.1184944 54,43.3239437 C54,43.1184944 50.6666667,39.4518278 44,32.3239437 Z" stroke-linecap="round" stroke-linejoin="round" transform="translate(49.000000, 37.823944) scale(-1, 1) translate(-49.000000, -37.823944) "></path>
                        <path vector-effect="non-scaling-stroke" d="M0.5,61 L356.5,61" stroke-linecap="round"></path>
                        <path vector-effect="non-scaling-stroke" d="M363.5,61 L373.5,61" stroke-linecap="round"></path>
                        </g>
                        </g>
                        <g transform="translate(146.000000, 62.000000)">
                        <g class="slds-illustration__fill-secondary">
                        <circle vector-effect="non-scaling-stroke" cx="66" cy="66" r="66"></circle>
                        <ellipse cx="66.5" cy="66" rx="38.5" ry="66"></ellipse>
                        <rect x="49.5" y="153.5" width="32" height="22"></rect>
                        </g>
                        <g transform="translate(4.000000, 0.000000)" fill="#FFFFFF">
                        <path vector-effect="non-scaling-stroke" d="M0.276855469,47.7788086 C4.72770182,36.0685221 11.8059896,26.5141602 21.5117188,19.1157227 C30.1201172,12.7973633 35.706543,9.09326172 48.0908203,6.87597656 C51.8487061,6.20316343 56.1575774,0.963049705 61.0175781,0.886230469 C66.9931232,0.791778465 73.7249109,6.08477534 80.3537012,7.83514372 C86.1008648,9.35271373 91.8836069,11.7592753 97.3378906,15.394043 C114.199707,26.6308594 117.956543,35.4946289 123.961914,47.7788086 C127.965495,55.9682617 127.643229,53.3107096 122.995117,39.8061523 L115.15625,26.3779297 L99.3500977,11.8393555 L79.3271484,3.14208984 L58.2192383,0.886230469 L41.0913086,4.39794922 L22.6689453,13.8129883 L6.44238281,30.0708008 L0.276855469,43.0327148 L0.276855469,47.7788086 Z"></path>
                        <path vector-effect="non-scaling-stroke" d="M30.494873,34.0495605 C30.494873,34.0495605 37.3376465,17.0495605 47.779541,9.9309082 C53.5096842,6.13435872 59.1995443,4.51472982 64.8491211,5.07202148 C69.2832031,5.49861654 73.9475098,7.55900065 78.842041,11.2531738 C86.1838379,16.7944336 92.1347656,27.7973633 95.4316406,35.8276367 C97.6295573,41.1811523 96.2676595,36.5566406 91.3459473,21.9541016 C85.9305827,14.9046224 83.0406087,11.2403971 82.6760254,10.9614258 C82.3114421,10.6824544 79.0512695,7.82503255 72.8955078,2.38916016 C68.7790927,0.889351294 65.6379734,0.119006242 63.4721497,0.078125 C61.306326,0.0372437583 58.0536466,0.686901961 53.7141113,2.02709961 L45.8171387,7.78222656 L37.4606934,16.3037109 C33.3729655,23.1031901 31.1993001,26.6408691 30.9396973,26.916748 C30.550293,27.3305664 30.494873,34.0495605 30.494873,34.0495605 Z"></path>
                        </g>
                        <circle vector-effect="non-scaling-stroke" class="slds-illustration__stroke-primary" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" cx="66" cy="66" r="66"></circle>
                        <ellipse class="slds-illustration__stroke-primary" stroke-width="3" stroke-linecap="round" stroke-linejoin="round" cx="66.5" cy="66" rx="38.5" ry="66"></ellipse>
                        <g transform="translate(24.000000, 117.000000)" class="slds-illustration__stroke-primary" stroke-linecap="round" stroke-linejoin="round" stroke-width="3">
                        <rect x="26.5" y="36.5" width="31" height="22"></rect>
                        <path vector-effect="non-scaling-stroke" d="M84,36 L58,0" transform="translate(71.000000, 18.000000) scale(-1, 1) translate(-71.000000, -18.000000) "></path>
                        <path vector-effect="non-scaling-stroke" d="M55,36 L48,14" transform="translate(51.500000, 25.000000) scale(-1, 1) translate(-51.500000, -25.000000) "></path>
                        <path vector-effect="non-scaling-stroke" d="M36,36 L29,14"></path>
                        <path vector-effect="non-scaling-stroke" d="M26,36 L0,0"></path>
                        </g>
                        </g>
                        <g transform="translate(426.000000, 113.000000)" class="slds-illustration__stroke-secondary" stroke-linecap="round" stroke-linejoin="round" stroke-width="3">
                        <g transform="translate(0.500000, 0.500000)">
                        <circle vector-effect="non-scaling-stroke" cx="33.5" cy="33.5" r="33"></circle>
                        <ellipse cx="33.75" cy="33.5" rx="19.25" ry="33"></ellipse>
                        <rect x="24.5" y="77" width="18" height="11"></rect>
                        <path vector-effect="non-scaling-stroke" d="M54.5,77 L41.5,59" transform="translate(48.000000, 68.000000) scale(-1, 1) translate(-48.000000, -68.000000) "></path>
                        <path vector-effect="non-scaling-stroke" d="M40,77 L36.5,66" transform="translate(38.250000, 71.500000) scale(-1, 1) translate(-38.250000, -71.500000) "></path>
                        <path vector-effect="non-scaling-stroke" d="M30.5,77 L27,66"></path>
                        <path vector-effect="non-scaling-stroke" d="M25.5,77 L12,59"></path>
                        </g>
                        </g>
                        <g transform="translate(72.000000, 194.000000)" class="slds-illustration__stroke-secondary" stroke-linecap="round" stroke-width="3">
                        <g transform="translate(31.713442, 25.088326) rotate(-15.000000) translate(-31.713442, -25.088326) translate(4.713442, 6.588326)">
                        <path vector-effect="non-scaling-stroke" d="M31.0360707,3.43528591 C31.0360707,3.43528591 40.5802283,0.671893051 42.6488424,10.6908663" transform="translate(36.842457, 6.888440) rotate(41.000000) translate(-36.842457, -6.888440) "></path>
                        <path vector-effect="non-scaling-stroke" d="M40.4282002,10.1797377 C40.4282002,10.1797377 49.9723578,7.4163448 52.0409719,17.435318" transform="translate(46.234586, 13.632892) scale(-1, 1) rotate(-41.000000) translate(-46.234586, -13.632892) "></path>
                        <path vector-effect="non-scaling-stroke" d="M0.730284783,29.5865514 C0.730284783,29.5865514 10.2744424,26.8231586 12.3430565,36.8421318"></path>
                        <path vector-effect="non-scaling-stroke" d="M12.7302848,29.5865514 C12.7302848,29.5865514 22.2744424,26.8231586 24.3430565,36.8421318" transform="translate(18.536671, 33.039705) scale(-1, 1) translate(-18.536671, -33.039705) "></path>
                        </g>
                        </g>
                        </g>
                        </g>
                        </g>
                        </svg>
                        <div class="slds-text-longform">
                        <h3 class="slds-text-heading_medium">No Data Found</h3>
                        </div>
                        </div>
                    </div>
                </div>
                </template> -->
            </template>
            <!-- Custom Filter Popup -->
            <template if:true={showPopup}>
                <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open slds-modal_large">
                    <div class="slds-modal__container slds-p-around_medium">
                      <header class="slds-modal__header slds-p-around_small slds-border_bottom">
                        <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse" title="Close" onclick={closePopup}>
                          <lightning-icon icon-name="utility:close" alternative-text="close" title="Close" size="xx-small"></lightning-icon>
                        </button>
                        <p class="slds-text-heading_medium">Add Condition</p>
                      </header>
                      <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">
                        <div class="slds-grid slds-grid_align-spread slds-m-bottom_small">
                            <div class="slds-col">
                                <p class="slds-text-heading_small slds-m-bottom_xx-small">Define Custom Logic</p>
                                <p class="slds-text-body_small">Define Custom Logic</p>
                            </div>
                            <div class="slds-col">
                                <button class="slds-button slds-button_neutral" onclick={clearLogic}>Clear</button>
                            </div>
                        </div>
                        <template if:true={customLogicData.length}>
                            <table class="slds-table slds-m-bottom_medium">
                                <thead>
                                    <tr>
                                        <th class="" scope="col">
                                            <div class="slds-truncate slds-text-body_small slds-text-color_weak" title="S.No">S.No.</div>
                                        </th>
                                        <th class="" scope="col">
                                            <div class="slds-truncate slds-text-body_small slds-text-color_weak" title="Condition Type">Condition Type</div>
                                        </th>
                                        <th class="" scope="col">
                                            <div class="slds-truncate slds-text-body_small slds-text-color_weak" title="Item">Item</div>
                                        </th>
                                        <th class="" scope="col">
                                            <div class="slds-truncate slds-text-body_small slds-text-color_weak" title="Condition Operator">Condition Operator</div>
                                        </th>
                                        <th class="" scope="col">
                                            <div class="slds-truncate slds-text-body_small slds-text-color_weak" title="Quantity">Quantity</div>
                                        </th>
                                        <th class="" scope="col">
                                            <div class="slds-truncate slds-text-body_small slds-text-color_weak" title="Actions">Actions</div>
                                        </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <template for:each={customLogicData} for:item="data">
                                        <tr class="slds-hint-parent" key={data.id}>
                                            <td data-label="S.No" scope="row">
                                                <p class="slds-text-body_small">1</p>
                                            </td>
                                            <td data-label="Condition Type">
                                                <div class="slds-truncate slds-text-body_small" title={data.conditionType}>{data.conditionType}</div>
                                            </td>
                                            <td data-label="Item">
                                                <div class="slds-truncate slds-text-body_small" title={data.conditionOperator}>{data.conditionOperator}</div>
                                            </td>
                                            <td data-label="Condition Operator">
                                                <div class="slds-truncate slds-text-body_small" title={data.objectName}>{data.objectName}</div>
                                            </td>
                                            <td data-label="Quantity">
                                                <div class="slds-truncate slds-text-body_small" title={data.conditionValue}>{data.conditionValue}</div>
                                            </td>
                                            <td data-label="Actions">
                                                <div class="slds-grid">
                                                    <lightning-button-icon
                                                        icon-name="utility:edit"
                                                        variant="border-filled"
                                                        alternative-text="Edit"
                                                        title="Edit"
                                                        size="x-small"
                                                        class="slds-m-right_small"
                                                        onclick={handleConditionEdit}>
                                                    </lightning-button-icon>
                                                    <lightning-button-icon
                                                        icon-name="utility:edit_form"
                                                        variant="border-filled"
                                                        alternative-text="Edit Form"
                                                        title="Edit Form"
                                                        size="x-small"
                                                        class="slds-m-right_small"
                                                        onclick={handleFormEdit}>
                                                    </lightning-button-icon>
                                                    <lightning-button-icon
                                                        icon-name="utility:delete"
                                                        variant="border-filled"
                                                        alternative-text="Delete"
                                                        title="Delete"
                                                        size="x-small"
                                                        class="slds-m-right_small"
                                                        onclick={handleConditionDelete}>
                                                    </lightning-button-icon>
                                                </div>
                                            </td>
                                        </tr>
                                    </template>
                                </tbody>
                            </table>
                        </template>
                        <div class="slds-grid slds-grid_align-spread">
                            <div class="slds-col dmpl-flex-1 slds-m-right_small">
                                <lightning-combobox name="conditionType" label="Condition Type" value={selectedConditionType} placeholder="Select Condition Type" options={conditionTypeOptions} onchange={handleConditionTypeChange} required></lightning-combobox>
                            </div>
                            <div class="slds-col dmpl-flex-1 slds-m-right_small">
                                <lightning-combobox name="conditionOperator" label="Condition Operator" value={selectedConditionOperator} placeholder="Select Condition Operator" options={conditionOperatorOptions} onchange={handleConditionOperatorChange} required></lightning-combobox>
                            </div>
                            <template if:true={showAdditionalConditions}>
                                <div class="slds-col dmpl-flex-1 slds-m-right_small">
                                    <lightning-combobox name="objectName" label="Object Name" value={selectedObjectName} placeholder="Select Object Name" options={objectNameOptions} onchange={handleObjectNameChange} required></lightning-combobox>
                                </div>
                                <div class="slds-col dmpl-flex-1 slds-m-right_small">
                                    <lightning-combobox name="conditionValue" label="Condition Value" value={selectedConditionValue} placeholder="Select Condition Value" options={conditionValueOptions} onchange={handleConditionValueChange} required></lightning-combobox>
                                </div>
                            </template>
                            <div class="slds-m-top_large">
                                <lightning-button-icon
                                    icon-name="utility:save"
                                    variant="border-filled"
                                    alternative-text="Save"
                                    title="Save"
                                    onclick={handleCustomFilterSave}>
                                </lightning-button-icon>
                                <lightning-button-icon
                                    icon-name="utility:close"
                                    variant="border-filled"
                                    alternative-text="Close"
                                    title="Close"
                                    onclick={handleConditionDelete}
                                    class="slds-m-left_medium">
                                </lightning-button-icon>
                            </div>
                        </div>                       
                      </div>
                      <footer class="slds-modal__footer slds-border_top slds-grid slds-grid_align-end">
                        <button class="slds-button slds-button_brand" onclick={closePopup}>Done</button>
                      </footer>
                    </div>
                  </section>
                  <div class="slds-backdrop slds-backdrop_open"></div>
            </template>

            <template if:true={showReports}>
                <!-- <div class="slds-grid slds-grid_align-start slds-m-bottom_small">
                    <div class="slds-grid slds-grid_align-start slds-box slds-box_x-small slds-grid slds-grid_vertical-align-center slds-text-link_reset" data-label="Bulk Processing Report" onclick={handleBack}>
                        <lightning-icon icon-name="utility:chevronleft" title="chevronleft" class="slds-m-right_xx-small" size="xx-small"></lightning-icon>
                        <p class="slds-text-body_small">Back to Process</p>
                    </div>
                </div> -->
                <div class="slds-m-top_medium">
                    <template if:true={bulkReportsLogs}>
                        <div class="slds-box slds-box_small slds-m-top_medium slds-theme_default slds-p-around_none">
                            <div class="slds-grid slds-wrap slds-grid_vertical-align-center slds-grid_align-spread slds-m-around_small">
                                <div class="slds-col slds-grid slds-grid_vertical-align-center">
                                    <lightning-icon icon-name="custom:custom15" title="custom15"></lightning-icon>
                                    <p class="slds-p-left_x-small">Bulk Processing Report</p>
                                </div>
                                <lightning-button label="Retry Failed" title="Retry Failed" onclick={handleRetryFailed}></lightning-button>
                            </div>
                            <div class="slds-grid slds-wrap slds-grid_vertical-align-center slds-grid_align-spread slds-m-bottom_small slds-m-horizontal_small">
                                <p class="header_title">50+ Items . Updated 5 minutes ago</p>
                                <div class="slds-grid slds-grid_vertical-align-center">
                                    <div class="slds-box slds-box_x-small slds-grid slds-grid_vertical-align-center slds-p-around_none slds-m-right_small">
                                        <p class="reports-filter slds-text-body_small slds-p-around_xx-small slds-border_right slds-text-link_reset dmpl-active" data-value="total" onclick={handleReportsFilter}>Total Records: <b>{allBulkReportsLength}</b></p>
                                        <p class="reports-filter slds-text-body_small slds-p-around_xx-small slds-border_right slds-text-link_reset" data-value="completed" onclick={handleReportsFilter}>Successfully Processed: <b>{completedBulkReportsLength}</b></p>
                                        <p class="reports-filter slds-text-body_small slds-p-around_xx-small slds-border_right slds-text-link_reset" data-value="pending" onclick={handleReportsFilter}>Failed: <b>{failedBulkReportsLength}</b></p>
                                    </div>
                                    <lightning-input type="search" label="Search" value={searchKey} placeholder="Search Document Name" onchange={handleBulkReportsSearch} variant="label-hidden"></lightning-input>
                                    <lightning-button-icon icon-name="utility:download" variant="border-filled" alternative-text="Download" title="Download" class="slds-m-left_small" onclick={handleDownload}></lightning-button-icon>
                                    <lightning-button-icon icon-name="utility:refresh" variant="border-filled" alternative-text="Refresh" title="Refresh" class="slds-m-left_small" onclick={handleRefresh}></lightning-button-icon>
                                </div>
                            </div>
                            <!-- Datatable here -->
                            <lightning-datatable
                                key-field="id"
                                data={bulkReportsLogs}
                                columns={columnsData}
                                show-row-number-column
                                onrowaction={handleRowActionReport}
                                onrowselection={handleSelectedRowsReport}>
                            </lightning-datatable>
                        </div>
                    </template>
                </div>
            </template>         
        </div>
    </div>
</template>